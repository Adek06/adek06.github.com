<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>类、数据与设计模式 | Gamer——游先生的个人网站</title>
<meta name="description" content="跟游戏有什么关系">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://adek06.github.io//favicon.ico?v=1564906574032">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://adek06.github.io//styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://adek06.github.io/">
        <img src="https://adek06.github.io//images/avatar.png?v=1564906574032" class="site-logo">
        <h1 class="site-title">Gamer——游先生的个人网站</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      跟游戏有什么关系
    </div>
    <div class="site-footer">
      我是游先生 | <a class="rss" href="https://adek06.github.io//atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">类、数据与设计模式</h2>
            <div class="post-date">2019-07-21</div>
            
            <div class="post-content">
              <p>面向对象真是一个有趣的玩法。</p>
<!--more-->
<p>与函数式的写法不同，在函数式中，数据是不可变的。比如我在最开始设定的数据，到达代码的最后，也不会发生任何变化。产生出来的东西只是它们做的映射。比如：</p>
<pre><code class="language-php">$A = 1
do_someting($A)
//A 还是 1
</code></pre>
<p>但对一个类而言，它本身就代表着数据类型。而它的方法便是对这些数据的操作。</p>
<p>在我最近看到的一个例子里，发现这么一种有趣的操作：一个类有两个静态变量，一个变量存储着从网页上传来的 JSON。另一个变量保存着过滤的参数。</p>
<pre><code class="language-php">clss A{
	static public $ajax = array();  
	static public $param = array();
}
</code></pre>
<p>在其它的类文件里，就可以通过这个类保存从网页上传来的参数。</p>
<pre><code class="language-php">class B{
	function __constuct(){
		if ($this-&gt;getRequest()-&gt;isXmlHttpRequest()) {  
			 Yaf_Dispatcher::getInstance()-&gt;autoRender(FALSE);  
			 header(&quot;Content-type:application/json;charset=utf-8&quot;);  
			 $json = file_get_contents(&quot;php://input&quot;);  
			 Filter::$ajax = json_decode($json, true);
		}
	}
}
</code></pre>
<p>因为是静态变量，于是，这个 A 类的变量就获得了参数。A 类的子类也得到了这个传过来的参数。于是，我们就可以用子类做一定的过滤。满足某个条件的参数，就放进 param 里。</p>
<pre><code class="language-php">class para_Filter extends A{
	public static do_some_filter(){
        if (isset(self::$ajax['content'])) {
            $content = self::contentValid();
            if ($banner['content'] == $content) {
		          echo &quot;content Error&quot;;
            }
            self::$param['content'] = $content;
        }
    }

    protected static function contentValid(){
        $stringLength = mb_strlen(self::$ajax['content'],'utf8');
        if ($stringLength&lt;1 || $stringLength &gt;10000){
            $content = false;
        }else{
            $content = self::$ajax['content'];
        }
        if (!$content){
				echo &quot;no content Error&quot;;
        }
        return $content;
    }
}
</code></pre>
<p>如果 B 类的子类想要数据，那么只要从 para_Filter 那么得到就可以了。下面也就是我们主函数的部分。</p>
<pre><code class="language-php">class xx_Action extends B{
	public mian(){
		para_Filter::do_some_filter();
		$content = A::param['content'];
	}

	public otherPost(){
		para_Filter::do_other_filter();
		...
	}
}
</code></pre>
<p>这一套下来，也就大体实现了一个过滤器。如果我要的不是传上来的的 content，想要做新的拓展，那只要再创建新的函数、新的类就可以了。我不用管参数怎么来，只要知道，传过来的东西符不符合我的标准就好了。如果我过滤的标准发生了变化，只要改变 para_Filter 里的方法就好了，其它的地方可以一概不动。</p>
<p>好玩的地方在于：可以看到，A 这个类没有方法，它就是一个数据的集合，一个数据结构。而它的子类，为它拓展了方法，但它们本身依然是数据结构。同时，它也随时在发生变化，而不是简单的映射。 虽然在我们的主函数里，没有对 A 这个类本身做过实例，也没有改变它的函数，但它在确确实实的产生了变化，而且还留在了它的基因里。</p>
<p>因此，我把类看成数据本身，也没错吧 ：)</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://adek06.github.io//tag/zSR6HUZr_" class="tag">
                    php
                  </a>
                
                  <a href="https://adek06.github.io//tag/3kzHvz1Lg" class="tag">
                    面向對象
                  </a>
                
                  <a href="https://adek06.github.io//tag/8XounFizo" class="tag">
                    学习
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://adek06.github.io//post/guan-yu-yaf-kuang-jia-de-yi-dian-dong-xi">
                  <h3 class="post-title">
                    初识 YAF 框架 和 MVC
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
